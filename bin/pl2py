#!/usr/bin/perl

use strict;

$_ = do { local $/; <> };

s/sub (\w+) {/def $1():/;
while (s/^\s+my\s+\$(\w+)\s+=\s+shift; *\n+//m) {
    my $var = $1;
    s/(def \w+\()\):/$1$var):/ or
    s/(def \w+\(.*)\):/$1, $var):/;
}

s/^ +\}\n//mg;
s/; *$//mg;
s/\$(\w+)/$1/g;
s/->/./g;
s/return 1/return True/g;
s/return 0/return False/g;
s/\((.*)\) \{/$1:/g;
s/ +\{ *$/:/mg;
s/\.can\(/.__getattr__(/g;
s/^ *my +//mg;

print $_;
